name: PR check

on:
  pull_request:
    branches: [ master, bamboo_pipeline_3.24_lts ]

jobs:
  engine-lint:
    uses: TencentBlueKing/bamboo-engine/.github/workflows/engine_flake8_and_black.yml@bamboo_pipeline_3.24_lts

  pipeline-lint:
    uses: TencentBlueKing/bamboo-engine/.github/workflows/runtime_pipeline_flake8_and_black.yml@bamboo_pipeline_3.24_lts

  engine-unittest:
    needs: engine-lint
    uses: TencentBlueKing/bamboo-engine/.github/workflows/engine_unittest.yml@bamboo_pipeline_3.24_lts

  pipeline-unittest:
    needs: pipeline-lint
    uses: TencentBlueKing/bamboo-engine/.github/workflows/runtime_pipeline_unittest.yml@bamboo_pipeline_3.24_lts
  
  runtime-pipeline-intergration-test:
    needs: [engine-unittest, pipeline-unittest]
    uses: TencentBlueKing/bamboo-engine/.github/workflows/runtime_pipeline_end_to_end_test.yml@bamboo_pipeline_3.24_lts
  
  pipeline-intergration-test:
    needs: pipeline-unittest
    uses: TencentBlueKing/bamboo-engine/.github/workflows/pipeline_end_to_end_test.yml@bamboo_pipeline_3.24_lts
